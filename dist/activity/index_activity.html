<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>晒合影活动</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
   		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
		<link rel="stylesheet" href="css/weui.min.css" />
		<style>
			html,body{
				width:100%;
				height:100%;				
			}
			ul,li{
				list-style: none;
			}
			.scroll-box{
				width:100%;
				background:url(img/bg.png) 100% no-repeat;
			}
			header{
				width:100%;
				background:url(img/head.png) no-repeat;
				background-size:contain;
			}
			.btnbox{
				overflow: hidden;
			}
			.regist-btn{
				background-color:#B3D465;
				width:35%;
				margin:15px auto 18px;
				box-shadow: 1px 2px 2px #1A3440;
			}
			.main{
				padding:5px 5px 10px;
			}
			.weui_search_bar {
			    background-color: #fff;
			}
			.weui_search_outer:after{
				background:#efeff4;
				border-color:#ddd;
				
			}
			.main ul.my-panel{
				overflow: hidden;
			}
			.main .my-panel>.panel-box{
				box-sizing: border-box;
				width:49.5%;
				float:left;
				padding:1em 5px 0.5em;
				margin-top:1%;
				background:#fff;
				position:relative;
				color:#fff;
			}
			.main .my-panel>.panel-box:nth-of-type(even){
				margin-right:0;
				float:right;				
			}
			.img-box{
				width:100%;
				overflow: hidden;
				margin-bottom:8px;
			}
			.img-box>img{
				width:100%;
				height:100%;
			}
			.panel-box>.panel-footer{
				overflow: hidden;
			}
			.panel-footer .perleft{
				float:left;
				width:40%;
				color:#B3D465;
				line-height:1.2;
				white-space: nowrap;
				
			}
			.panel-footer .perleft>p{
				text-overflow: clip;				
			}
			.panel-footer button{
				float:right;
				width:60%;
				background:#B3D465;
				white-space: nowrap;
				text-overflow: clip;
			}
			.panel-box>p.checkbox{
				position:absolute;
				padding:0 3px;
				top:1em;
				right:1em;
				background:url(img/4.png) no-repeat;
				background-size:cover;
			}
			.panel-box>p.checkbox:after{
				content:"";
				display:block;
				height:3px;
				width:100%;				
			}
			.main .my-paging{
				color:#333;
				overflow: hidden;
				text-align: center;
				box-sizing: border-box;
				padding:1em 0;
			}
			.my-paging ul{
				overflow:hidden;
				
			}
			.my-paging ul>li{
				float:left;
				padding:0 0.5em 0 0;
			}
			.my-paging .sigpage input{
				width:2em;
				background:rgba(255,255,255,0.3);
				border:none;
				border-radius:4px;
				outline: none;
				padding:3px 1em;
				text-align: center;
				color:#333;
			}
			.pagelist>span:active{
				color:#fff;
			}
		</style>
	</head>
	<body ontouchstart="">
		<div class="scroll-box">
			<header></header>
			<div class='btnbox'>
				<a id="goRegist" class='weui_btn weui_btn_primary regist-btn'>我要报名</a>
			</div>
			<div class="main">
				<div class="weui_search_bar" id="searchinp">
			        <form class="weui_search_outer">
			            <div class="weui_search_inner">
			                <i class="weui_icon_search"></i>
			                <input type="search" class="weui_search_input" id="search_input" placeholder="请输入姓名或编号">
			                <a href="javascript:" class="weui_icon_clear" id="search_clear"></a>
			            </div>
			            <label for="search_input" class="weui_search_text" id="search_text" style="display: none;">
			                <i class="weui_icon_search"></i>
			                <span>搜索</span>
			            </label>
			        </form>
			        <a href="javascript:" class="weui_search_cancel" id="search_cancel">确认</a>
			    </div>
				<ul class="my-panel">
					<li class="panel-box">
						<div class="img-box">
							<img src="img/6.png" class="panel-img">
						</div>
						<div class="panel-footer">
							<div class='perleft'>
								<span class="name">测试1</span>
								<p>
									<span class='ticNum'>7956</span>票
								</p>
							</div>
							<button class='weui_btn weui_btn_primary'>投他一票</button>
						</div>	
						<p class="checkbox">编号<span class="checkNum">5785</span></p>
					</li>
					<li class="panel-box">
						<div class="img-box">
							<img src="img/7.png" class="panel-img">
						</div>
						<div class="panel-footer">
							<div class='perleft'>
								<span class="name">测试2</span>
								<p>
									<span class='ticNum'>99999</span>票
								</p>
							</div>
							<button class='weui_btn weui_btn_primary'>投他一票</button>
						</div>	
						<p class="checkbox">编号<span class="checkNum">5785</span></p>
					</li>
					<li class="panel-box">
						<div class="img-box">
							<img src="img/6.png" class="panel-img">
						</div>
						<div class="panel-footer">
							<div class='perleft'>
								<span class="name">测试1</span>
								<p>
									<span class='ticNum'>7956</span>票
								</p>
							</div>
							<button class='weui_btn weui_btn_primary'>投他一票</button>
						</div>	
						<p class="checkbox">编号<span class="checkNum">5785</span></p>
					</li>
					<li class="panel-box">
						<div class="img-box">
							<img src="img/7.png" class="panel-img">
						</div>
						<div class="panel-footer">
							<div class='perleft'>
								<span class="name">测试1</span>
								<p>
									<span class='ticNum'>7956</span>票
								</p>
							</div>
							<button class='weui_btn weui_btn_primary'>投他一票</button>
						</div>	
						<p class="checkbox">编号<span class="checkNum">5785</span></p>
					</li>
					<li class="panel-box">
						<div class="img-box">
							<img src="img/6.png" class="panel-img">
						</div>
						<div class="panel-footer">
							<div class='perleft'>
								<span class="name">测试1</span>
								<p>
									<span class='ticNum'>7956</span>票
								</p>
							</div>
							<button class='weui_btn weui_btn_primary'>投他一票</button>
						</div>	
						<p class="checkbox">编号<span class="checkNum">5785</span></p>
					</li>
					<li class="panel-box">
						<div class="img-box">
							<img src="img/7.png" class="panel-img">
						</div>
						<div class="panel-footer">
							<div class='perleft'>
								<span class="name">测试1</span>
								<p>
									<span class='ticNum'>7956</span>票
								</p>
							</div>
							<button class='weui_btn weui_btn_primary'>投他一票</button>
						</div>	
						<p class="checkbox">编号<span class="checkNum">5785</span></p>
					</li>
					<li class="panel-box">
						<div class="img-box">
							<img src="img/6.png" class="panel-img">
						</div>
						<div class="panel-footer">
							<div class='perleft'>
								<span class="name">测试1</span>
								<p>
									<span class='ticNum'>7956</span>票
								</p>
							</div>
							<button class='weui_btn weui_btn_primary'>投他一票</button>
						</div>	
						<p class="checkbox">编号<span class="checkNum">5785</span></p>
					</li>
					<li class="panel-box">
						<div class="img-box">
							<img src="img/7.png" class="panel-img">
						</div>
						<div class="panel-footer">
							<div class='perleft'>
								<span class="name">测试1</span>
								<p>
									<span class='ticNum'>7956</span>票
								</p>
							</div>
							<button class='weui_btn weui_btn_primary'>投他一票</button>
						</div>	
						<p class="checkbox">编号<span class="checkNum">5785</span></p>
					</li>
				</ul>
				<div class='my-paging'>
					<p class='pagelist'>
						
							<span>上一页</span>
							<span>1</span>
							<span>2</span>
							<span class="my-clip">&middot;&middot;&middot;&middot;</span>
							<span class="last-pg">51</span>
							<span class="last-pg">52</span>
							<span>下一页</span>
						
					</p>
					<p class='sigpage'>
						跳到
						<input type="number" value="1"/>
						页
					</p>
				</div>
			</div>
		</div>
		
	</body>
	<script src="js/jquery-2.1.4.min.js"></script>
	<script>
		jQuery(function($){
			var page=1;//当前页码
			var pageSize=8;//单页面显示的用户数量；
			var MAXPAGE=52;
			var openid="";
			 //获取url参数
			var request={};
			function UrlSearch(){
			   var name,value; 
			   var str=location.href; //取得整个地址栏
			   var num=str.indexOf("?") 
			   str=str.substr(num+1); //取得所有参数   stringvar.substr(start [, length ]
			
			   var arr=str.split("&"); //各个参数放到数组里
			   for(var i=0;i < arr.length;i++){ 
				    num=arr[i].indexOf("="); 
				    if(num>0){ 
					    name=arr[i].substring(0,num);
					    value=arr[i].substr(num+1);
					    request[name]=value;
				    } 
			   } 
			}; 
			UrlSearch();
			//我要报名
			$("#goRegist").on('touchstart',function(e){
				e.preventDefault();
				if(request.openid){
					window.location.href="http://www.elepick.com/dist/activity/regist.html?openid="+request.openid;
				}else{
					//未关注公众号
					alert("请关注公众号");
				}
			});
			//页码变化时的ajax,并解析渲染
			function ajaxPage(){
				$(".sigpage>input").val(page);
//				$.getJSON({"http://www.elepick.com/api"
					
					
					//图片宽高自适应设置；
					var imgboxWidth=$("div.img-box").width();
					$("div.img-box").each(function(){
						$(this).css("height",imgboxWidth+"px");
					});
//				});
			};
			
			var telWidth=$(window).width();//屏幕宽度
			$('header').css("height",telWidth+"px");
			//搜索框
			$("#searchinp input[type='search']").focus(function(){
				$("#search_cancel").show(0);
			});
			$("#searchinp input[type='search']").blur(function(){
				$("#search_cancel").hide(0);
			});
			//搜索框清除点击事件
			$("#searchinp").on('touchstart','#search_clear',function(){
				$("#searchinp input[type='search']").val("");
			});
			//////////////
			//上一页，下一页
			$(".pagelist").on('touchstart','span',function(e){
				if($(e.target).index()==0){
					//上一页
					if(page>1){
						page--;
						ajaxPage();
					}
					if(page<=1){
						page=1;
					}
				}else if((e.target)==$(".pagelist>span:last-of-type").get(0)){
					//下一页
					if(page<MAXPAGE){
						page++;
						ajaxPage();
					}
					if(page>=MAXPAGE){
						page=MAXPAGE;
					}
					
				}else{
					if(Number($(e.target).html())>=1){
						var oldpage=page;
						page=Number($(e.target).html());
						if(page==oldpage){}else{
							ajaxPage();
						}
					}
				}
			});
			//页面直接跳转
			$(".sigpage").on("input",'input',function(e){
				
				if(($(e.target).val()>0)&&($(e.target).val()<=MAXPAGE)){
					//有效页码
					var mycache=$(e.target).val();
					setTimeout(function(){
						if($(e.target).val()==mycache){
							page=$(e.target).val();
							ajaxPage();
						};
					},600);
					
					
				}
			});
			
			
			
			
			
			
			
			
			
			
			
			
			
			
		});
	</script>
</html>
